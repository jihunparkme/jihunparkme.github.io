---
layout: post
title: 03. ëª¨ë“  ê°ì²´ì˜ ê³µí†µ ë©”ì„œë“œ
summary: ëª¨ë“  ê°ì²´ì˜ ê³µí†µ ë©”ì„œë“œ
categories: (Book)Effective-JAVA-3/E JAVA
featured-img: EFF_JAVA
# mathjax: true
---

# 3ì¥. ëª¨ë“  ê°ì²´ì˜ ê³µí†µ ë©”ì„œë“œ

## item 10. equalsëŠ” ì¼ë°˜ ê·œì•½ì„ ì§€ì¼œ ì¬ì •ì˜í•˜ë¼.

equals ë©”ì„œë“œì˜ ì¬ì •ì˜ì—ëŠ” í•¨ì •ì´ ë„ì‚¬ë¦¬ê³  ìˆëŠ”ë°, ì´ ë¬¸ì œë¥¼ íšŒí”¼í•˜ëŠ” ê°€ì¥ ì‰¬ìš´ ê¸¸ì€ ì•„ì˜ˆ ì¬ì •ì˜ë¥¼ í•˜ì§€ ì•ŠëŠ” ê²ƒ.

ğŸ”ì•„ë˜ ìƒí™© ì¤‘ í•˜ë‚˜ì— í•´ë‹¹í•œë‹¤ë©´ equals ë©”ì„œë“œë¥¼ ì¬ì •ì˜í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ìµœì„ 

- **ê° ì¸ìŠ¤í„´ìŠ¤ê°€ ë³¸ì§ˆì ìœ¼ë¡œ ê³ ìœ í•  ê²½ìš°**
    - ê°’ì„ í‘œí˜„í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ë™ì‘í•˜ëŠ” ê°œì²´ë¥¼ í‘œí˜„í•˜ëŠ” í´ë˜ìŠ¤(ex. Thread)
- **ì¸ìŠ¤í„´ìŠ¤ì˜ 'ë…¼ë¦¬ì  ë™ì¹˜ì„±'ì„ ê²€ì‚¬í•  ì¼ì´ ì—†ì„ ê²½ìš°**
- **ìƒìœ„ í´ë˜ìŠ¤ì—ì„œ ì¬ì •ì˜í•œ equalsê°€ í•˜ìœ„ í´ë˜ìŠ¤ì—ë„ ë”± ë“¤ì–´ë§ì„ ê²½ìš°**
    - Set, List, Map êµ¬í˜„ì²´ë“¤ì€ ìƒì†ì„ ë°›ì•„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- **í´ë˜ìŠ¤ê°€ private, package-privateì´ê³  equals ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ì¼ì´ ì—†ì„ ê²½ìš°**
    - equalsê°€ ì‹¤ìˆ˜ë¡œë¼ë„ í˜¸ì¶œë˜ëŠ” ê²ƒì„ ë§‰ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•´ë‘ì.

```java
@Override public boolean equals(Object o) {
    throw new AssertioniError(); // í˜¸ì¶œ ê¸ˆì§€!
}
```

ğŸ”equalsë¥¼ ì¬ì •ì˜í•´ì•¼ í•˜ëŠ” ê²½ìš°

- ê°ì²´ ì‹ë³„ì„±ì´ ì•„ë‹Œ ë…¼ë¦¬ì  ë™ì¹˜ì„±ì„ í™•ì¸í•´ì•¼ í•˜ëŠ”ë°, ìƒìœ„ í´ë˜ìŠ¤ì˜ equalsê°€ ë…¼ë¦¬ì  ë™ì¹˜ì„±ì„ ë¹„êµí•˜ë„ë¡ ì¬ì •ì˜ë˜ì§€ ì•Šì•˜ì„ ê²½ìš°
  - (ex. ì£¼ë¡œ ê°’ í´ë˜ìŠ¤. Integer, String ..)
- ê°’ í´ë˜ìŠ¤ë¼ í•´ë„, ê°’ì´ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ê°€ ë‘˜ ì´ìƒ ë§Œë“¤ì–´ì§€ì§€ ì•ŠìŒì„ ë³´ì¥í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ í†µì œ í´ë˜ìŠ¤ë¼ë©´ equalsë¥¼ ì¬ì •ì˜í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. (ex. Enum)

ğŸ”equals ë©”ì„œë“œë¥¼ ì¬ì •ì˜í•  ë•ŒëŠ” ë°˜ë“œì‹œ ì¼ë°˜ ê·œì•½ì„ ë”°ë¼ì•¼ í•¨

- equals ë©”ì„œë“œëŠ” ë™ì¹˜ê´€ê³„(equivalence relation)ë¥¼ ë§Œì¡±í•˜ë©° ë‹¤ì„¯ ê°€ì§€ ìš”ê±´ì„ ë§Œì¡±
  - ë™ì¹˜ê´€ê³„: ì§‘í•©ì„ ì„œë¡œ ê°™ì€ ì›ì†Œë“¤ë¡œ ì´ë¤„ì§„ ë¶€ë¶„ì§‘í•©ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ì—°ì‚°
    - ì´ ë¶€ë¶„ì§‘í•©ë“¤ì„ ë™ì¹˜ë¥˜(equivalence class; ë™ì¹˜ í´ë˜ìŠ¤)ë¼ê³  í•¨
  
**`ë°˜ì‚¬ì„±(reflexivity)`**
- nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ xì— ëŒ€í•´, x.equals(x)ëŠ” trueë‹¤.
- ê°ì²´ëŠ” ìê¸° ìì‹ ê³¼ ê°™ì•„ì•¼ í•œë‹¤.

**`ëŒ€ì¹­ì„±(symmetry)`**
- nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ x, yì— ëŒ€í•´, x.equals(y)ê°€ trueë©´ y.equals(x)ë„ trueë‹¤.
- ë‘ ê°ì²´ëŠ” ì„œë¡œì— ëŒ€í•œ ë™ì¹˜ ì—¬ë¶€ì— ë˜‘ê°™ì´ ë‹µí•´ì•¼ í•œë‹¤.
  - equals ê·œì•½ì„ ì–´ê¸°ë©´ ê·¸ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” ë‹¤ë¥¸ ê°ì²´ë“¤ì´ ì–´ë–»ê²Œ ë°˜ì‘í• ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.

[ğŸ“ ëŒ€ì¹­ì„± ìœ„ë°° ì½”ë“œ](https://github.com/WegraLee/effective-java-3e-source-code/blob/master/src/effectivejava/chapter3/item10/CaseInsensitiveString.java)

ğŸ“ ëŒ€ì¹­ì„±ì„ ìœ„ë°°í•˜ì§€ ì•ŠëŠ” ì½”ë“œ

```java
private final String s;
// ...
@Override public boolean equals(Object o) {
    return o instanceof CaseInsensitiveString &&
        ((CaseInsensitiveString) o).s.equalsIgnoreCase(s);
}
```

**`ì¶”ì´ì„±(transitivity)`**
- nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ x, y, zì— ëŒ€í•´, x.equals(y)ê°€ trueê³ , y.equals(z)ë„ trueë©´ x.equals(z)ë„ trueë‹¤.
- ì²« ë²ˆì§¸ ê°ì²´ì™€ ë‘ ë²ˆì§¸ ê°ì²´ê°€ ê°™ê³ , ë‘ ë²ˆì§¸ ê°ì²´ì™€ ì„¸ ë²ˆì§¸ ê°ì²´ê°€ ê°™ë‹¤ë©´, ì²« ë²ˆì§¸ ê°ì²´ì™€ ì„¸ ë²ˆì§¸ ê°ì²´ë„ ê°™ì•„ì•¼ í•œë‹¤.
  - êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ í™•ì¥í•´ ìƒˆë¡œìš´ ê°’ì„ ì¶”ê°€í•˜ë©´ì„œ equals ê·œì•½ì„ ë§Œì¡±ì‹œí‚¬ ë°©ë²•ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.

[ğŸ“equals ê·œì•½ì„ ì§€í‚¤ë©´ì„œ ê°’ ì¶”ê°€í•˜ê¸° (ìƒì† ëŒ€ì‹  ì»´í¬ì§€ì…˜ì„ ì‚¬ìš©)](https://github.com/WegraLee/effective-java-3e-source-code/blob/master/src/effectivejava/chapter3/item10/composition/ColorPoint.java)

`ì¼ê´€ì„±(consistency)`
- nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ x, yì— ëŒ€í•´, x.equals(y)ë¥¼ ë°˜ë³µí•´ì„œ í˜¸ì¶œí•˜ë©´ í•­ìƒ trueë¥¼ ë°˜í™˜í•˜ê±°ë‚˜ í•­ìƒ falseë¥¼ ë°˜í™˜í•œë‹¤.
- ë‘ ê°ì²´ê°€ ê°™ë‹¤ë©´ ì•ìœ¼ë¡œë„ ì˜ì›íˆ ê°™ì•„ì•¼ í•œë‹¤.
  - í´ë˜ìŠ¤ê°€ ë¶ˆë³€ì´ë“  ê°€ë³€ì´ë“  equalsì˜ íŒë‹¨ì— ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ìì›ì´ ë¼ì–´ë“¤ê²Œ í•´ì„œëŠ” ì•ˆ ëœë‹¤.
  - ëª¨ë“  ê°ì²´ê°€ nullê³¼ ê°™ì§€ ì•Šì•„ì•¼ í•œë‹¤.

`null-ì•„ë‹˜`
- nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ xì— ëŒ€í•´, x.equals(null)ì€ falseë‹¤.

ğŸ“ëª…ì‹œì  null ê²€ì‚¬ëŠ” ë¶ˆí•„ìš”

```java
@Override public boolean equals(Object o) {
    // equalsê°€ íƒ€ì…ì„ í™•ì¸í•˜ì§€ ì•Šìœ¼ë©´ ì˜ëª»ëœ íƒ€ì…ì´ ì¸ìˆ˜ë¡œ ì£¼ì–´ì¡Œì„ ë•Œ,
    // ClassCastExceptionì„ ë˜ì ¸ ì¼ë°˜ ê·œì•½ì„ ìœ„ë°°
    if (o == null)
        return false;
    // ...
}
```

ğŸ“ë¬µì‹œì  null ê²€ì‚¬ë¥¼

```java
@Override public boolean equals(Object o) {
    // nullì´ ì¸ìˆ˜ë¡œ ì£¼ì–´ì§€ë©´ falseë¥¼ ë°˜í™˜
    if (!(o instanceof MyType))
        return false;
    MyType mt = (MyType) o;
    // ...
}
```

ğŸ”**ì–‘ì§ˆì˜ equals ë©”ì„œë“œ êµ¬í˜„ ë°©ë²•**

1. `== ì—°ì‚°ìë¥¼ ì‚¬ìš©í•´ ì…ë ¥ì´ ìê¸° ìì‹ ì˜ ì°¸ì¡°ì¸ì§€ í™•ì¸í•œë‹¤.`
   - ìê¸° ìì‹ ì´ë©´ true ë°˜í™˜
2. `instanceof ì—°ì‚°ìë¡œ ì…ë ¥ì´ ì˜¬ë°”ë¥¸ íƒ€ì…ì¸ì§€ í™•ì¸í•œë‹¤.`
3. `ì…ë ¥ì„ ì˜¬ë°”ë¥¸ íƒ€ì…ìœ¼ë¡œ í˜•ë³€í™˜í•œë‹¤.`
4. `ì…ë ¥ ê°ì²´ì™€ ìê¸° ìì‹ ì˜ ëŒ€ì‘ë˜ëŠ” í•µì‹¬í•„ë“œë“¤ì´ ëª¨ë‘ ì¼ì¹˜í•˜ëŠ”ì§€ í•˜ë‚˜ì”© ê²€ì‚¬í•œë‹¤.`

- Float.compare()ì™€ Double.compare()ì„ ì œì™¸í•œ ê¸°ë³¸ íƒ€ì… í•„ë“œëŠ” == ì—°ì‚°ìë¡œ ë¹„êµ
- equalsì˜ ì„±ëŠ¥ì„ ìœ„í•´ ë‹¤ë¥¼ ê°€ëŠ¥ì„±ì´ ë” í¬ê±°ë‚˜ ë¹„êµ ë¹„ìš©ì´ ì‹¼ í•„ë“œë¥¼ ë¨¼ì € ë¹„êµí•˜ì.
- equalsë¥¼ ë‹¤ êµ¬í˜„í–ˆë‹¤ë©´ `ëŒ€ì¹­ì `, `ì¶”ì´ì„±`, `ì¼ê´€ì `ì¸ì§€ ìë¬¸í•´ë³´ì.

ğŸ“ì „í˜•ì ì¸ equals ë©”ì„œë“œì˜ ì˜ˆ

```java
public final class PhoneNumber {
    private final short areaCode, prefix, lineNum;

    public PhoneNumber(int areaCode, int prefix, int lineNum) {
        this.areaCode = rangeCheck(areaCode, 999, "ì§€ì—­ì½”ë“œ");
        this.prefix   = rangeCheck(prefix,   999, "í”„ë¦¬í”½ìŠ¤");
        this.lineNum  = rangeCheck(lineNum, 9999, "ê°€ì…ì ë²ˆí˜¸");
    }

    private static short rangeCheck(int val, int max, String arg) {
        if (val < 0 || val > max)
            throw new IllegalArgumentException(arg + ": " + val);
        return (short) val;
    }

    @Override public boolean equals(Object o) { // ì…ë ¥ íƒ€ì…ì€ ë°˜ë“œì‹œ Object (ë‹¤ì¤‘ì •ì˜)
		// í•„ë“œë“¤ì˜ ë™ì¹˜ì„±ë§Œ ê²€ì‚¬í•´ë„ equals ê·œì•½ì„ ì–´ë µì§€ ì•Šê²Œ ì§€í‚¬ ìˆ˜ ìˆë‹¤.
        if (o == this) return true;
        if (!(o instanceof PhoneNumber)) return false;

        PhoneNumber pn = (PhoneNumber)o;
        return pn.lineNum == lineNum && pn.prefix == prefix
                && pn.areaCode == areaCode;
    }

    // equalsë¥¼ ì¬ì •ì˜í•  ë• hashCodeë„ ë°˜ë“œì‹œ ì¬ì •ì˜í•˜ì!
}
```

ğŸ””

> ê¼­ í•„ìš”í•œ ê²½ìš°ê°€ ì•„ë‹ˆë©´ equalsë¥¼ ì¬ì •ì˜í•˜ì§€ ë§ì.
> ë§ì€ ê²½ìš°ì— Objectì˜ equalsê°€ ì—¬ëŸ¬ë¶„ì´ ì›í•˜ëŠ” ë¹„êµë¥¼ ì •í™•íˆ ìˆ˜í–‰í•´ì¤€ë‹¤.
> ì¬ì •ì˜í•´ì•¼ í•  ë•ŒëŠ” ê·¸ í´ë˜ìŠ¤ì˜ í•µì‹¬ í•„ë“œ ëª¨ë‘ë¥¼ ë¹ ì§ì—†ì´,
> ë‹¤ì„¯ ê°€ì§€ ê·œì•½ì„ í™•ì‹¤íˆ ì§€ì¼œê°€ë©° ë¹„êµí•´ì•¼ í•œë‹¤.

<br>

## item 11. equalsë¥¼ ì¬ì •ì˜í•˜ë ¤ê±°ë“  hashCodeë„ ì¬ì •ì˜í•˜ë¼

- equalsë¥¼ ì¬ì •ì˜í•œ í´ë˜ìŠ¤ ëª¨ë‘ì—ì„œ hashCodeë„ ì¬ì •ì˜í•´ì•¼ í•œë‹¤.

**Object ëª…ì„¸ì—ì„œ ë°œì·Œí•œ ê·œì•½**

- equals ë¹„êµì— ì‚¬ìš©ë˜ëŠ” ì •ë³´ê°€ ë³€ê²½ë˜ì§€ ì•Šì•˜ë‹¤ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ ê·¸ ê°ì²´ì˜ hashCode ë©”ì„œë“œëŠ” ëª‡ ë²ˆì„ í˜¸ì¶œí•´ë„ ì¼ê´€ë˜ê²Œ í•­ìƒ ê°™ì€ ê°’ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤.
- equals(Object)ê°€ ë‘ ê°ì²´ë¥¼ ê°™ë‹¤ê³  íŒë‹¨í–ˆë‹¤ë©´, ë‘ ê°ì²´ì˜ hashCodeëŠ” ë˜‘ê°™ì€ ê°’ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤.
- equals(Object)ê°€ ë‘ ê°ì²´ë¥¼ ë‹¤ë¥´ë‹¤ê³  íŒë‹¨í–ˆë”ë¼ë„, ë‘ ê°ì²´ì˜ hashCodeê°€ ì„œë¡œ ë‹¤ë¥¸ ê°’ì„ ë°˜í™˜í•  í•„ìš”ëŠ” ì—†ë‹¤. ë‹¨, ë‹¤ë¥¸ ê°ì²´ì— ëŒ€í•´ì„œëŠ” ë‹¤ë¥¸ ê°’ì„ ë°˜í™˜í•´ì•¼ í•´ì‹œí…Œì´ë¸”ì˜ ì„±ëŠ¥ì´ ì¢‹ì•„ì§„ë‹¤.

**ì¢‹ì€ hashCodeë¥¼ ì‘ì„±í•˜ëŠ” ê°„ë‹¨í•œ ìš”ë ¹**

1. int ë³€ìˆ˜ resultë¥¼ ì„ ì–¸í•œ í›„ ê°’ cë¡œ ì´ˆê¸°í™”í•œë‹¤. ì´ë•Œ cëŠ” í•´ë‹¹ ê°ì²´ì˜ ì²«ë²ˆì§¸ í•µì‹¬ í•„ë“œë¥¼ ë‹¨ê³„ 2.a ë°©ì‹ìœ¼ë¡œ ê³„ì‚°í•œ í•´ì‹œì½”ë“œë‹¤. (ì—¬ê¸°ì„œ í•µì‹¬ í•„ë“œë€ equals ë¹„êµì— ì‚¬ìš©ë˜ëŠ” í•„ë“œ)
2. í•´ë‹¹ ê°ì²´ì˜ ë‚˜ë¨¸ì§€ í•µì‹¬ í•„ë“œ f ê°ê°ì— ëŒ€í•´ ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.
   - a. í•´ë‹¹ í•„ë“œì˜ í•´ì‹œì½”ë“œ cë¥¼ ê³„ì‚°í•œë‹¤.
     - ê¸°ë³¸ íƒ€ì… í•„ë“œë¼ë©´, Type.hashCode(f)ë¥¼ ìˆ˜í–‰í•œë‹¤. ì—¬ê¸°ì„œ Typeì€ í•´ë‹¹ ê¸°ë³¸ íƒ€ì…ì˜ ë°•ì‹± í´ë˜ìŠ¤ë‹¤.
     - ì°¸ì¡° íƒ€ì… í•„ë“œë©´ì„œ ì´ í´ë˜ìŠ¤ì˜ equals ë©”ì„œë“œê°€ ì´ í•„ë“œì˜ equalsë¥¼ ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•´ ë¹„êµí•œë‹¤ë©´, ì´ í•„ë“œì˜ hashCodeë¥¼ ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œí•œë‹¤. ê³„ì‚°ì´ ë” ë³µì¡í•´ì§ˆ ê²ƒ ê°™ë‹¤ë©´, ì´ í•„ë“œì˜ í‘œì¤€í˜•ì„ ë§Œë“¤ì–´ ê·¸ í‘œì¤€í˜•ì˜ hashCodeë¥¼ í˜¸ì¶œí•œë‹¤. í•„ë“œì˜ ê°’ì´ nullì´ë©´ ë³´í†µ 0ì„ ì‚¬ìš©)
     - í•„ë“œê°€ ë°°ì—´ì´ë¼ë©´, í•µì‹¬ ì›ì†Œ ê°ê°ì„ ë³„ë„ í•„ë“œì²˜ëŸ¼ ë‹¤ë£¬ë‹¤. ì´ìƒì˜ ê·œì¹™ì„ ì¬ê·€ì ìœ¼ë¡œ ì ìš©í•´ ê° í•µì‹¬ ì›ì†Œì˜ í•´ì‹œì½”ë“œë¥¼ ê³„ì‚°í•œ ë‹¤ìŒ, ë‹¨ê³„ 2.b ë°©ì‹ìœ¼ë¡œ ê°±ì‹ í•œë‹¤. ë°°ì—´ì— í•µì‹¬ ì›ì†Œê°€ í•˜ë‚˜ë„ ì—†ë‹¤ë©´ ë‹¨ìˆœíˆ ìƒìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. ëª¨ë“  ì›ì†Œê°€ í•µì‹¬ ì›ì†Œë¼ë©´ Arrays.hashCodeë¥¼ ì‚¬ìš©í•œë‹¤.
   - b. ë‹¨ê³„ 2.aì—ì„œ ê³„ì‚°í•œ í•´ì‹œì½”ë“œ cë¡œ resultë¥¼ ê°±ì‹ í•œë‹¤. ì½”ë“œë¡œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. `result = 31 * result + c;`
3. resultë¥¼ ë°˜í™˜í•œë‹¤.

- hashCodeë¥¼ ë‹¤ êµ¬í˜„í–ˆë‹¤ë©´ ì´ ë©”ì„œë“œê°€ ë™ì¹˜ì¸ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ ë˜‘ê°™ì€ í•´ì‹œì½”ë“œë¥¼ ë°˜í™˜í• ì§€ ìë¬¸í•´ë³´ì.
- ë‹¨ê³„ 2.bì˜ ê³±ì…ˆ 31 \* resultëŠ” í•„ë“œë¥¼ ê³±í•˜ëŠ” ìˆœì„œì— ë”°ë¼ result ê°’ì´ ë‹¬ë¼ì§€ê²Œ í•œë‹¤.
  - (31ì€ í™€ìˆ˜ì´ë©´ì„œ ì†Œìˆ˜ì´ê¸° ë•Œë¬¸ì— ì‚¬ìš©)

ğŸ“ ì „í˜•ì ì¸ hashCode ë©”ì„œë“œ

```java
// ì „í™”ë²ˆí˜¸ì— hashCode ë¶€ì—¬
@Override public int hashCode() {
    int result = Short.hashCode(areaCode);
    result = 31 * result + Short.hashCode(prefix);
    result = 31 * result + Short.hashCode(lineNum);
    return result;
}
```

ğŸ“ í•œ ì¤„ì§œë¦¬ hashCode ë©”ì„œë“œ (ì„±ëŠ¥ì´ ì•„ì‰¬ì›€)

```java
@Override public int hashCode() {
    // ì¸ìˆ˜ë¥¼ ë‹´ê¸° ìœ„í•œ ë°°ì—´ ìƒì„±, ë°•ì‹±-ì–¸ë°•ì‹± ë“±ìœ¼ë¡œ ëŠë¦¬ë‹¤.
    return Object.hash(lineNum, prefix, areaCode);
}
```

ğŸ“ í•´ì‹œì½”ë“œë¥¼ ì§€ì—°(lazy initialization) ì´ˆê¸°í™”í•˜ëŠ” hashCode ë©”ì„œë“œ (ìŠ¤ë ˆë“œ ì•ˆì •ì„±ê¹Œì§€ ê³ ë ¤í•´ì•¼ í•¨)

```java
private int hashCode; // ìë™ìœ¼ë¡œ 0ìœ¼ë¡œ ì´ˆê¸°í™”ëœë‹¤.

@Override public int hashCode() {
    int result = hashCode;
    if (result == 0) {
        result = Short.hashCode(areaCode);
        result = 31 * result + Short.hashCode(prefix);
        result = 31 * result + Short.hashCode(lineNum);
        hashCode = result;
    }
    return result;
}
```

ğŸ””

> equalsë¥¼ ì¬ì •ì˜í•  ë•ŒëŠ” hashCodeë„ ë°˜ë“œì‹œ ì¬ì •ì˜í•´ì•¼ í•œë‹¤.
> ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ í”„ë¡œê·¸ë¨ì´ ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šì„ ê²ƒì´ë‹¤.
> ì¬ì •ì˜í•œ hashCodeëŠ” Objectì˜ API ë¬¸ì„œì— ê¸°ìˆ ëœ ì¼ë°˜ ê·œì•½ì„ ë”°ë¼ì•¼ í•˜ë©°, ì„œë¡œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ë¼ë©´ ë˜ë„ë¡ í•´ì‹œì½”ë“œë„ ì„œë¡œ ë‹¤ë¥´ê²Œ êµ¬í˜„í•´ì•¼ í•œë‹¤.
> ì´ë ‡ê²Œ êµ¬í˜„í•˜ê¸°ê°€ ì–´ë µì§€ëŠ” ì•Šì§€ë§Œ ì¡°ê¸ˆ ë”°ë¶„í•œ ì¼ì´ê¸´ í•˜ë‹¤.
> í•˜ì§€ë§Œ AutoValue í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë©‹ì§„ equalsì™€ hashCodeë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.

<br>

## item 12. toStringì„ í•­ìƒ ì¬ì •ì˜í•˜ë¼.

- toStringì„ ì˜ êµ¬í˜„í•œ í´ë˜ìŠ¤ëŠ” ì‚¬ìš©í•˜ê¸°ì— í›¨ì”¬ ì¦ê²ê³ , ê·¸ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œ ì‹œìŠ¤í…œì€ ë””ë²„ê¹…í•˜ê¸° ì‰½ë‹¤.
- ì‹¤ì „ì—ì„œ toStringì€ ê·¸ ê°ì²´ê°€ ê°€ì§„ ì£¼ìš” ì •ë³´ ëª¨ë‘ë¥¼ ë°˜í™˜í•˜ëŠ” ê²Œ ì¢‹ë‹¤.

ğŸ“ í¬ë§·ì„ ëª…ì‹œí•œ ê²½ìš°

```java
public final class PhoneNumber {
    //..

    /**
     * ë‹¨ì ì€ í‰ìƒ ì´ í¬ë§·ì— ì–½ë§¤ì´ëŠ” ì .
     *
     * ì´ ì „í™”ë²ˆí˜¸ì˜ ë¬¸ìì—´ í‘œí˜„ì„ ë°˜í™˜í•œë‹¤.
     * ì´ ë¬¸ìì—´ì€ "XXX-YYY-ZZZZ" í˜•íƒœì˜ 12ê¸€ìë¡œ êµ¬ì„±ëœë‹¤.
     * XXXëŠ” ì§€ì—­ ì½”ë“œ, YYYëŠ” í”„ë¦¬í”½ìŠ¤, ZZZZëŠ” ê°€ì…ì ë²ˆí˜¸ë‹¤.
     * ê°ê°ì˜ ëŒ€ë¬¸ìëŠ” 10ì§„ìˆ˜ ìˆ«ì í•˜ë‚˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
     *
     * ì „í™”ë²ˆí˜¸ì˜ ê° ë¶€ë¶„ì˜ ê°’ì´ ë„ˆë¬´ ì‘ì•„ì„œ ìë¦¿ìˆ˜ë¥¼ ì±„ìš¸ ìˆ˜ ì—†ë‹¤ë©´,
     * ì•ì—ì„œë¶€í„° 0ìœ¼ë¡œ ì±„ì›Œë‚˜ê°„ë‹¤. ì˜ˆì»¨ëŒ€ ê°€ì…ì ë²ˆí˜¸ê°€ 123ì´ë¼ë©´
     * ì „í™”ë²ˆí˜¸ì˜ ë§ˆì§€ë§‰ ë„¤ ë¬¸ìëŠ” "0123"ì´ ëœë‹¤.
     */
    @Override public String toString() {
        return String.format("%03d-%03d-%04d", areaCode, prefix, lineNum);
    }
}
```

ğŸ””

> ëª¨ë“  êµ¬ì²´ í´ë˜ìŠ¤ì—ì„œ Objectì˜ toStringì„ ì¬ì •ì˜í•˜ì.
> ìƒìœ„ í´ë˜ìŠ¤ì—ì„œ ì´ë¯¸ ì•Œë§ê²Œ ì¬ì •ì˜í•œ ê²½ìš°ëŠ” ì˜ˆì™¸ë‹¤. toStringì„ ì¬ì –ì˜í•œ í´ë˜ìŠ¤ëŠ” ì‚¬ìš©í•˜ê¸°ë„ ì¦ê²ê³  ê·¸ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œ ì‹œìŠ¤í…œì„ ë””ë²„ê¹…í•˜ê¸° ì‰½ê²Œ í•´ì¤€ë‹¤.
> toStringì€ í•´ë‹¹ ê°ì²´ì— ê´€í•œ ëª…í™•í•˜ê³  ìœ ìš©í•œ ì •ë³´ë¥¼ ì½ê¸° ì¢‹ì€ í˜•íƒœë¡œ ë°˜í™˜í•´ì•¼ í•œë‹¤.

<br>

## item 13. clone ì¬ì •ì˜ëŠ” ì£¼ì˜í•´ì„œ ì§„í–‰í•˜ë¼.

- Cloneableì„ êµ¬í˜„í•œ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ cloneì„ í˜¸ì¶œí•˜ë©´ ê·¸ ê°ì²´ì˜ í•„ë“œë“¤ì„ í•˜ë‚˜í•˜ë‚˜ ë³µì‚¬í•œ ê°ì²´ë¥¼ ë°˜í™˜í•˜ë©°, ê·¸ë ‡ì§€ ì•Šì€ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ í˜¸ì¶œí•˜ë©´ CloneNotSupportedExceptionì„ ë˜ì§„ë‹¤.

ğŸ“ ê°€ë³€ ìƒíƒœë¥¼ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” í´ë˜ìŠ¤ìš© clone ë©”ì„œë“œ

```java
public final class PhoneNumber implements Cloneable {
    // ...
    @Override public PhoneNumber clone() {
        try {
            // ì¬ì •ì˜í•œ ë©”ì„œë“œì˜ ë°˜í™˜ íƒ€ì…ì€ ìƒìœ„ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œê°€ ë°˜í™˜í•˜ëŠ” íƒ€ì…ì˜ í•˜ìœ„ íƒ€ì…ì¼ ìˆ˜ ìˆë‹¤.
            return (PhoneNumber) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new AssertionError();  // ì¼ì–´ë‚  ìˆ˜ ì—†ëŠ” ì¼ì´ë‹¤.
        }
    }
}
```

- clone ë©”ì„œë“œëŠ” ì‚¬ì‹¤ìƒ ìƒì„±ìì™€ ê°™ì€ íš¨ê³¼ë¥¼ ë‚¸ë‹¤.
  - cloneì€ ì›ë³¸ ê°ì²´ì— ì•„ë¬´ëŸ° í•´ë¥¼ ë¼ì¹˜ì§€ ì•ŠëŠ” ë™ì‹œì— ë³µì œëœ ê°ì²´ì˜ ë¶ˆë³€ì‹ì„ ë³´ì¥í•´ì•¼ í•œë‹¤.

ğŸ“ ê°€ë³€ ìƒíƒœë¥¼ ì°¸ì¡°í•˜ëŠ” í´ë˜ìŠ¤ìš© clone ë©”ì„œë“œ

```java
public class Stack {
    private Object[] elements;
    private int size = 0;
    // ...

    @Override public Stack clone() {
    try {
	    Stack result = (Stack) super.clone();
        // elements í•„ë“œê°€ ë³µì‚¬ë³¸ê³¼ ê°™ì€ ë©”ëª¨ë¦¬ë¥¼ ì°¸ì¡°í•˜ì§€ ì•Šë„ë¡ ë°°ì—´ì˜ cloneì„ ì¬ê·€ì ìœ¼ë¡œ í˜¸ì¶œ
        result.elements = elements.clone();
        return result;
    } catch (CloneNotSupportedException e) {
        throw new AssertionError();
    }
}
```

ğŸ“ ë³µì¡í•œ ê°€ë³€ ìƒíƒœë¥¼ ê°–ëŠ” í´ë˜ìŠ¤ìš© ì¬ê·€ì  clone ë©”ì„œë“œ

```java
public class HashTable implements Cloneable {
    private Entry[] buckets = ...;

    private static class Entry {
        final Object key;
        Object value;
        Entry next;

        Entry(Object key, Object value, Entry next) {
            this.key = key;
            this.value = value;
            this.next = next;
        }

        // 1. ì´ ì—”íŠ¸ë¦¬ê°€ ê°€ë¦¬í‚¤ëŠ” ì—°ê²° ë¦¬ìŠ¤íŠ¸ë¥¼ ì¬ê·€ì ìœ¼ë¡œ ë³µì‚¬
        // ì¬ê·€ í˜¸ì¶œë¡œ ë¦¬ìŠ¤íŠ¸ê°€ ê¸¸ë©´ stackOverFlowë¥¼ ì¼ìœ¼í‚¬ ìœ„í—˜
        Entry deepCopyRecursion() {
            return new Entry(key, value, next == null ? null : next.deepCopy());
        }

        // 2. ì¬ê·€ í˜¸ì¶œì˜ stackOverFlow ë¬¸ì œë¥¼ í”¼í•˜ê¸° ìœ„í•´ ë°˜ë³µìë¥¼ ì‚¬ìš©
        Entry deepCopy() {
            Entry result = new Entry(key, value, next);
            for (Entry p = result; p.next != null; p = p.next) {
                p.next = new Entry(p.next.key, p.next.value, p.next.next);
            }
            return result;
        }

        @Override public HashTable clone() {
            try {
                HashTable result = (HashTable) super.clone();
                result.bucket = new Entry[buckets.length];
                for (int i = 0; i < buckets.length; i++) {
                    if (buckets[i] != null) {
                        result.buckets[i] = buckets[i].deepCopy();
                    }
                }
                return result;
            } catch (CloneNotSupportedException e) {
                throw new AssertionError();
            }
        }

        // ..
    }
}
```

- Cloneableì„ êµ¬í˜„í•˜ëŠ” ëª¨ë“  í´ë˜ìŠ¤ëŠ” cloneì„ ì¬ì •ì˜í•´ì•¼ í•œë‹¤.
- ë³µì‚¬ ìƒì„±ìì™€ ë³µì‚¬ íŒ©í„°ë¦¬ëŠ” ë” ë‚˜ì€ ê°ì²´ ë³µì‚¬ ë°©ì‹ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.
  - ì¥ì .
  - ë¬¸ì„œí™”ëœ ê·œì•½ì— ê¸°ëŒ€ì§€ ì•Šê³ , ì •ìƒì ì¸ final í•„ë“œ ìš©ë²•ê³¼ ì¶©ëŒí•˜ì§€ ì•Šê³ , ë¶ˆí•„ìš”í•œ ê²€ì‚¬ ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•Šê³ , í˜•ë³€í™˜ë„ í•„ìš”í•˜ì§€ ì•Šê³ , ...
  - í•´ë‹¹ í´ë˜ìŠ¤ê°€ êµ¬í˜„í•œ interface íƒ€ì…ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¸ìˆ˜ë¡œ ë°›ì„ ìˆ˜ ìˆìŒ
  - í´ë¼ì´ì–¸íŠ¸ëŠ” ì›ë³¸ì˜ êµ¬í˜„ íƒ€ì…ì— ì–½ë§¤ì´ì§€ ì•Šê³  ë³µì œë³¸ì˜ íƒ€ì…ì„ ì§ì ‘ ì„ íƒí•  ìˆ˜ ìˆìŒ

ğŸ“ ë³µì‚¬ ìƒì„±ì (ë³€í™˜ ìƒì„±ì, conversion constructor)

```java
// ìì‹ ê³¼ ê°™ì€ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¸ìˆ˜ë¡œ ë°›ëŠ” ìƒì„±ì
public Yum(Yum yum) {
    //..
}
```

ğŸ“ ë³µì‚¬ íŒ©í„°ë¦¬ (ë³€í™˜ íŒ©í„°ë¦¬, conversion factory)

```java
// ë³µì‚¬ ìƒì„±ìë¥¼ ëª¨ë°©í•œ ì •ì  íŒ©í„°ë¦¬
public static Yum newInstance(Yum yum) {
    // ..
}
```

> Cloneableì´ ëª°ê³  ì˜¨ ëª¨ë“  ë¬¸ì œë¥¼ ë˜ì§šì–´ë´¤ì„ ë•Œ,
> ìƒˆë¡œìš´ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ ë•ŒëŠ” ì ˆëŒ€ Cloneableì„ í™•ì¥í•´ì„œëŠ” ì•ˆ ë˜ë©°, ìƒˆë¡œìš´ í´ë˜ìŠ¤ë„ ì´ë¥¼ êµ¬í˜„í•´ì„œëŠ” ì•ˆ ëœë‹¤.
> final í´ë˜ìŠ¤ë¼ë©´ Cloneableì„ êµ¬í˜„í•´ë„ ìœ„í—˜ì´ í¬ì§€ ì•Šì§€ë§Œ, ì„±ëŠ¥ ìµœì í™” ê´€ì ì—ì„œ ê²€í† í•œ í›„ ë³„ë‹¤ë¥¸ ë¬¸ì œê°€ ì—†ì„ ë•Œë§Œ ë“œë¬¼ê²Œ í˜€ìš©í•´ì•¼ í•œë‹¤.
> ê¸°ë³¸ ì›ì¹™ì€ 'ë³µì œ ê¸°ëŠ¥ì€ ìƒì„±ìì™€ íŒ©í„°ë¦¬ë¥¼ ì´ìš©í•˜ëŠ” ê²Œ ìµœê³  !!' ë¼ëŠ” ê²ƒì´ë‹¤.
> ë‹¨, ë°°ì—´ë§Œì€ clone ë©”ì„œë“œ ë°©ì‹ì´ ê°€ì¥ ê¹”ë”í•œ, ì´ ê·œì¹™ì˜ í•©ë‹¹í•œ ì˜ˆì™¸ë¼ê³  í•  ìˆ˜ ìˆë‹¤.

<br>

## item 14. Comparableì„ êµ¬í˜„í• ì§€ ê³ ë ¤í•˜ë¼.

- ì•ŒíŒŒë²³, ìˆ«ì, ì—°ëŒ€ ê°™ì´ ìˆœì„œê°€ ëª…í™•í•œ ê°’ í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤ë©´ ë°˜ë“œì‹œ Comparable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì.

```java
public interface Comparable<T> {
    int compareTo(T t);
}
```

- compareTo ë©”ì„œë“œì˜ ì¼ë°˜ ê·œì•½ì€ equalsì˜ ê·œì•½ê³¼ ë¹„ìŠ·
  - Comparableì„ êµ¬í˜„í•œ í´ë˜ìŠ¤ëŠ” ëª¨ë“  x,yì— ëŒ€í•œ sgn(x.compareTo(y)) == -sgn(y.compareTo(x))ì—¬ì•¼ í•œë‹¤.
    - ë”°ë¼ì„œ, x.compareTo(y)ëŠ” y.compareTo(x)ê°€ ì˜ˆì™¸ë¥¼ ë˜ì§ˆ ë•Œì— í•œí•´ ì˜ˆì™¸ë¥¼ ë˜ì ¸ì•¼ í•œë‹¤.
  - Comparableì„ êµ¬í˜„í•œ í´ë˜ìŠ¤ëŠ” ì¶”ì´ì„±ì„ ë³´ì¥í•´ì•¼ í•œë‹¤.
  - Comparableì„ êµ¬í˜„í•œ í´ë˜ìŠ¤ëŠ” ëª¨ë“  zì— ëŒ€í•´ x.compareTo(y) == 0 ì´ë©´ sgn(x.compareTo(z)) == sgn(y.compareTo(z))
  - (x.compareTo(y) == 0) == (x.equals(y))ì—¬ì•¼ í•œë‹¤.

ğŸ“ ê¸°ë³¸ íƒ€ì… í•„ë“œê°€ ì—¬ëŸ¿ì¼ ë•Œì˜ ë¹„êµì

```java
public int compareTo (PhoneNumber pn) {
    int result = Short.compare(areaCode, pn.areaCode);	// ê°€ì¥ ì¤‘ìš”í•œ í•„ë“œ
    if (result == 0) {
        result = Short.compare(prefix, pn.prefix);	// ë‘ ë²ˆì§¸ë¡œ ì¤‘ìš”í•œ í•„ë“œ
        if (result == 0) {
         	result = Short.compare(lineNum, pn.lineNum);	// ì„¸ ë²ˆì§¸ë¡œ ì¤‘ìš”í•œ í•„ë“œ
        }
    }
    return result;
}
```

ğŸ“ ë¹„êµì ìƒì„± ë©”ì„œë“œë¥¼ í™œìš©í•œ ë¹„êµì

- ìë°”ì˜ ì •ì  ì„í¬íŠ¸ ê¸°ëŠ¥ì„ ì´ìš©í•˜ë©´ ì •ì  ë¹„êµì ìƒì„± ë©”ì„œë“œë“¤ì„ ê·¸ ì´ë¦„ë§Œìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ ì½”ë“œê°€ í›¨ì”¬ ê¹”ë”í•´ì§„ë‹¤.

```java
private static final Comparator<PhoneNumber> COMPARATOR =
    	comparingInt((PhoneNumber pn) -> pn.areaCode)
    		.thenComparingInt(pn -> pn.prefix)
    		.thenComparingInt(pn -> pn.lineNum);

public int compareTo(PhoneNumber pn) {
    return COMPARATOR.compare(this, pn);
}
```

-

ğŸ“ğŸ””ğŸ”

- [effective-java-3e-source-code (KOR)](https://github.com/WegraLee/effective-java-3e-source-code)

- [effective-java-3e-source-code (EN)](https://github.com/jbloch/effective-java-3e-source-code)
