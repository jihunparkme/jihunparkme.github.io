---
layout: post
title: 03. ëª¨ë“  ê°ì²´ì˜ ê³µí†µ ë©”ì„œë“œ
summary: ëª¨ë“  ê°ì²´ì˜ ê³µí†µ ë©”ì„œë“œ
categories: (Book)Effective-JAVA-3/E
featured-img: EFF_JAVA
# mathjax: true
---

# Table of Contents

**3ì¥. ëª¨ë“  ê°ì²´ì˜ ê³µí†µ ë©”ì„œë“œ**

- [item 10. equalsëŠ” ì¼ë°˜ ê·œì•½ì„ ì§€ì¼œ ì¬ì •ì˜í•˜ë¼](#item-10-equalsëŠ”-ì¼ë°˜-ê·œì•½ì„-ì§€ì¼œ-ì¬ì •ì˜í•˜ë¼)
- [item 11. equalsë¥¼ ì¬ì •ì˜í•˜ë ¤ê±°ë“  hashCodeë„ ì¬ì •ì˜í•˜ë¼](#item-11-equalsë¥¼-ì¬ì •ì˜í•˜ë ¤ê±°ë“ -hashCodeë„-ì¬ì •ì˜í•˜ë¼)
  

<br>

# 3ì¥. ëª¨ë“  ê°ì²´ì˜ ê³µí†µ ë©”ì„œë“œ

<br>

## item 10. equalsëŠ” ì¼ë°˜ ê·œì•½ì„ ì§€ì¼œ ì¬ì •ì˜í•˜ë¼.

- equals ë©”ì„œë“œëŠ” ì•„ë˜ ìƒí™© ì¤‘ í•˜ë‚˜ì— í•´ë‹¹í•œë‹¤ë©´ ì¬ì •ì˜í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ìµœì„ 
  - *ê° ì¸ìŠ¤í„´ìŠ¤ê°€ ë³¸ì§ˆì ìœ¼ë¡œ ê³ ìœ í•˜ë‹¤.*
    - ê°’ì„ í‘œí˜„í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ë™ì‘í•˜ëŠ” ê°œì²´ë¥¼ í‘œí˜„í•˜ëŠ” í´ë˜ìŠ¤(ex. Thread)
  - *ì¸ìŠ¤í„´ìŠ¤ì˜ 'ë…¼ë¦¬ì  ë™ì¹˜ì„±'ì„ ê²€ì‚¬í•  ì¼ì´ ì—†ë‹¤.*
  - *ìƒìœ„ í´ë˜ìŠ¤ì—ì„œ ì¬ì •ì˜í•œ equalsê°€ í•˜ìœ„ í´ë˜ìŠ¤ì—ë„ ë”± ë“¤ì–´ë§ëŠ”ë‹¤.*
    - Set, List, Map êµ¬í˜„ì²´ë“¤ì€ ìƒì†ì„ ë°›ì•„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
  - í´ë˜ìŠ¤ê°€ privateê±°ë‚˜ package-privateì´ê³ , equals ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ì¼ì´ ì—†ë‹¤.
    - equalsê°€ ì‹¤ìˆ˜ë¡œë¼ë„ í˜¸ì¶œë˜ëŠ” ê²ƒì„ ë§‰ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•´ë‘ì.

```java
@Override public boolean equals(Object o) {
    throw new AssertioniError(); // í˜¸ì¶œ ê¸ˆì§€!
}
```

- equalsë¥¼ ì¬ì •ì˜í•´ì•¼ í•  ë•ŒëŠ”
  - ê°ì²´ ì‹ë³„ì„±ì´ ì•„ë‹Œ ë…¼ë¦¬ì  ë™ì¹˜ì„±ì„ í™•ì¸í•´ì•¼ í•˜ëŠ”ë°, ìƒìœ„ í´ë˜ìŠ¤ì˜ equalsê°€ ë…¼ë¦¬ì  ë™ì¹˜ì„±ì„ ë¹„êµí•˜ë„ë¡ ì¬ì •ì˜ë˜ì§€ ì•Šì•˜ì„ ë•Œ.!
    - ì£¼ë¡œ ê°’ í´ë˜ìŠ¤(ex. Integer, String ..)
  - ê°’ í´ë˜ìŠ¤ë¼ í•´ë„, ê°’ì´ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ê°€ ë‘˜ ì´ìƒ ë§Œë“¤ì–´ì§€ì§€ ì•ŠìŒì„ ë³´ì¥í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ í†µì œ í´ë˜ìŠ¤ë¼ë©´ equalsë¥¼ ì¬ì •ì˜í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
- ğŸ”equals ë©”ì„œë“œëŠ” ë™ì¹˜ê´€ê³„(equivalence relation)ë¥¼ êµ¬í˜„í•˜ë©°, ì•„ë˜ë¥¼ ë§Œì¡±
  - `ë°˜ì‚¬ì„±(reflexivity)` : nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ xì— ëŒ€í•´, x.equals(x)ëŠ” trueë‹¤.
  - `ëŒ€ì¹­ì„±(symmetry)` : nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ x, yì— ëŒ€í•´, x.equals(y)ê°€ trueë©´ y.equals(x)ë„ trueë‹¤.
  - `ì¶”ì´ì„±(transitivity)` : nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ x, y, zì— ëŒ€í•´, x.equals(y)ê°€ trueê³ , y.equals(z)ë„ trueë©´ x.equals(z)ë„ trueë‹¤.
  - `ì¼ê´€ì„±(consistency)` : nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ x, yì— ëŒ€í•´, x.equals(y)ë¥¼ ë°˜ë³µí•´ì„œ í˜¸ì¶œí•˜ë©´ í•­ìƒ trueë¥¼ ë°˜í™˜í•˜ê±°ë‚˜ í•­ìƒ falseë¥¼ ë°˜í™˜í•œë‹¤.
  - `null-ì•„ë‹˜` : nullì´ ì•„ë‹Œ ëª¨ë“  ì°¸ì¡° ê°’ xì— ëŒ€í•´, x.equals(null)ì€ falseë‹¤.

ğŸ”**ë™ì¹˜ê´€ê³„**

- ì§‘í•©ì„ ì„œë¡œ ê°™ì€ ì›ì†Œë“¤ë¡œ ì´ë¤„ì§„ ë¶€ë¶„ì§‘í•©ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ì—°ì‚°
  - ì´ ë¶€ë¶„ì§‘í•©ë“¤ì„ ë™ì¹˜ë¥˜(equivalence class; ë™ì¹˜ í´ë˜ìŠ¤)ë¼ê³  í•¨

ğŸ”**`ë™ì¹˜ê´€ê³„`ë¥¼ ë§Œì¡±ì‹œí‚¤ê¸° ìœ„í•œ ë‹¤ì„¯ ìš”ê±´**

1. `ë°˜ì‚¬ì„±` : ê°ì²´ëŠ” ìê¸° ìì‹ ê³¼ ê°™ì•„ì•¼ í•œë‹¤.
2. `ëŒ€ì¹­ì„±` : ë‘ ê°ì²´ëŠ” ì„œë¡œì— ëŒ€í•œ ë™ì¹˜ ì—¬ë¶€ì— ë˜‘ê°™ì´ ë‹µí•´ì•¼ í•œë‹¤.
   - equals ê·œì•½ì„ ì–´ê¸°ë©´ ê·¸ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” ë‹¤ë¥¸ ê°ì²´ë“¤ì´ ì–´ë–»ê²Œ ë°˜ì‘í• ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.

ğŸ“ëŒ€ì¹­ì„±ì„ ìœ„ë°°í•˜ëŠ” ì½”ë“œ

```java
public final class CaseInsensitiveString {
    private final String s;
    // ...
    @Override public boolean equals(Object o) {
        if (o instanceof CaseInsensitiveString)
            return s.equalsIgnoreCase(
            ((CaseInsensitiveString) o).s);
        if (o instanceof String)  // í•œ ë°©í–¥ìœ¼ë¡œë§Œ ì‘ë™!
            return s.equalsIgnoreCase((String) o);
        return false;
    }
}
```

ğŸ“ìˆ˜ì •ëœ equals

```java
private final String s;
// ...
@Override public boolean equals(Object o) {
    return o instanceof CaseInsensitiveString &&
        ((CaseInsensitiveString) o).s.equalsIgnoreCase(s);
}
```

3. `ì¶”ì´ì„±` : ì²« ë²ˆì§¸ ê°ì²´ì™€ ë‘ ë²ˆì§¸ ê°ì²´ê°€ ê°™ê³ , ë‘ ë²ˆì§¸ ê°ì²´ì™€ ì„¸ ë²ˆì§¸ ê°ì²´ê°€ ê°™ë‹¤ë©´, ì²« ë²ˆì§¸ ê°ì²´ì™€ ì„¸ ë²ˆì§¸ ê°ì²´ë„ ê°™ì•„ì•¼ í•œë‹¤.
   - êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ í™•ì¥í•´ ìƒˆë¡œìš´ ê°’ì„ ì¶”ê°€í•˜ë©´ì„œ equals ê·œì•½ì„ ë§Œì¡±ì‹œí‚¬ ë°©ë²•ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
   - ex) <u>*Point*</u> Classì™€ Point Classë¥¼ ìƒì†ë°›ì€ <u>*ColorPoint*</u> Class ì˜ equals.

ğŸ“equals ê·œì•½ì„ ì§€í‚¤ë©´ì„œ ê°’ ì¶”ê°€í•˜ê¸° (ìƒì† ëŒ€ì‹  ì»´í¬ì§€ì…˜ì„ ì‚¬ìš©)

```java
public class ColorPoint {
    private final Point point;
    private final Color color;

    public ColorPoint(int x, int y, Color color) {
        point = new Point(x, y);
        this.color = Objects.requireNonNull(color);
    }

    // ì´ ColorPointì˜ Point ë·°ë¥¼ ë°˜í™˜
    public Point asPoint() {
        return point;
    }

    @Override public boolean equals(Object o) {
        if (!(o instanceof ColorPoint))
            return false;
        ColorPoint cp = (ColorPoint) o;
        return cp.point.equals(point) && cp.color.equals(color);
    }

    @Override public int hashCode() {
        return 31 * point.hashCode() + color.hashCode();
    }
}
```

4. `ì¼ê´€ì„±` : ë‘ ê°ì²´ê°€ ê°™ë‹¤ë©´ ì•ìœ¼ë¡œë„ ì˜ì›íˆ ê°™ì•„ì•¼ í•œë‹¤.
   - í´ë˜ìŠ¤ê°€ ë¶ˆë³€ì´ë“  ê°€ë³€ì´ë“  equalsì˜ íŒë‹¨ì— ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ìì›ì´ ë¼ì–´ë“¤ê²Œ í•´ì„œëŠ” ì•ˆ ëœë‹¤.
   - ëª¨ë“  ê°ì²´ê°€ nullê³¼ ê°™ì§€ ì•Šì•„ì•¼ í•œë‹¤.

ğŸ“ëª…ì‹œì  null ê²€ì‚¬ëŠ” ë¶ˆí•„ìš”í•˜ë‹¤.

```java
@Override public boolean equals(Object o) {
    // equalsê°€ íƒ€ì…ì„ í™•ì¸í•˜ì§€ ì•Šìœ¼ë©´ ì˜ëª»ëœ íƒ€ì…ì´ ì¸ìˆ˜ë¡œ ì£¼ì–´ì¡Œì„ ë•Œ,
    // ClassCastExceptionì„ ë˜ì ¸ ì¼ë°˜ ê·œì•½ì„ ìœ„ë°°
    if (o == null) 
        return false;
    // ...
}
```

ğŸ“ë¬µì‹œì  null ê²€ì‚¬ê°€ ë‚«ë‹¤.

```java
@Override public boolean equals(Object o) {
    // nullì´ ì¸ìˆ˜ë¡œ ì£¼ì–´ì§€ë©´ falseë¥¼ ë°˜í™˜
    if (!(o instanceof MyType)) 
        return false;
    MyType mt = (MyType) o;
    // ...
}
```

ğŸ”**ì–‘ì§ˆì˜ equals ë©”ì„œë“œ êµ¬í˜„ ë°©ë²•**

1. `== ì—°ì‚°ìë¥¼ ì‚¬ìš©í•´ ì…ë ¥ì´ ìê¸° ìì‹ ì˜ ì°¸ì¡°ì¸ì§€ í™•ì¸í•œë‹¤.`
   - ìê¸° ìì‹ ì´ë©´ true ë°˜í™˜
2. `instanceof ì—°ì‚°ìë¡œ ì…ë ¥ì´ ì˜¬ë°”ë¥¸ íƒ€ì…ì¸ì§€ í™•ì¸í•œë‹¤.`
3. `ì…ë ¥ì„ ì˜¬ë°”ë¥¸ íƒ€ì…ìœ¼ë¡œ í˜•ë³€í™˜í•œë‹¤.`
4. `ì…ë ¥ ê°ì²´ì™€ ìê¸° ìì‹ ì˜ ëŒ€ì‘ë˜ëŠ” í•µì‹¬í•„ë“œë“¤ì´ ëª¨ë‘ ì¼ì¹˜í•˜ëŠ”ì§€ í•˜ë‚˜ì”© ê²€ì‚¬í•œë‹¤.`

- Float.compare()ì™€ Double.compare()ì„ ì œì™¸í•œ ê¸°ë³¸ íƒ€ì… í•„ë“œëŠ” == ì—°ì‚°ìë¡œ ë¹„êµ
- equalsì˜ ì„±ëŠ¥ì„ ìœ„í•´ ë‹¤ë¥¼ ê°€ëŠ¥ì„±ì´ ë” í¬ê±°ë‚˜ ë¹„êµ ë¹„ìš©ì´ ì‹¼ í•„ë“œë¥¼ ë¨¼ì € ë¹„êµí•˜ì.
- equalsë¥¼ ë‹¤ êµ¬í˜„í–ˆë‹¤ë©´ `ëŒ€ì¹­ì `, `ì¶”ì´ì„±`, `ì¼ê´€ì `ì¸ì§€ ìë¬¸í•´ë³´ì.

ğŸ“ì „í˜•ì ì¸ equals ë©”ì„œë“œì˜ ì˜ˆ

```java
public final class PhoneNumber {
    private final short areaCode, prefix, lineNum;

    public PhoneNumber(int areaCode, int prefix, int lineNum) {
        this.areaCode = rangeCheck(areaCode, 999, "ì§€ì—­ì½”ë“œ");
        this.prefix   = rangeCheck(prefix,   999, "í”„ë¦¬í”½ìŠ¤");
        this.lineNum  = rangeCheck(lineNum, 9999, "ê°€ì…ì ë²ˆí˜¸");
    }

    private static short rangeCheck(int val, int max, String arg) {
        if (val < 0 || val > max)
            throw new IllegalArgumentException(arg + ": " + val);
        return (short) val;
    }

    @Override public boolean equals(Object o) { // ì…ë ¥ íƒ€ì…ì€ ë°˜ë“œì‹œ Object (ë‹¤ì¤‘ì •ì˜)
		// í•„ë“œë“¤ì˜ ë™ì¹˜ì„±ë§Œ ê²€ì‚¬í•´ë„ equals ê·œì•½ì„ ì–´ë µì§€ ì•Šê²Œ ì§€í‚¬ ìˆ˜ ìˆë‹¤.
        if (o == this) return true;
        if (!(o instanceof PhoneNumber)) return false;
        
        PhoneNumber pn = (PhoneNumber)o;
        return pn.lineNum == lineNum && pn.prefix == prefix
                && pn.areaCode == areaCode;
    }

    // equalsë¥¼ ì¬ì •ì˜í•  ë• hashCodeë„ ë°˜ë“œì‹œ ì¬ì •ì˜í•˜ì!
}
```

ğŸ””

> ê¼­ í•„ìš”í•œ ê²½ìš°ê°€ ì•„ë‹ˆë©´ equalsë¥¼ ì¬ì •ì˜í•˜ì§€ ë§ì.
> ë§ì€ ê²½ìš°ì— Objectì˜ equalsê°€ ì—¬ëŸ¬ë¶„ì´ ì›í•˜ëŠ” ë¹„êµë¥¼ ì •í™•íˆ ìˆ˜í–‰í•´ì¤€ë‹¤.
> ì¬ì •ì˜í•´ì•¼ í•  ë•ŒëŠ” ê·¸ í´ë˜ìŠ¤ì˜ í•µì‹¬ í•„ë“œ ëª¨ë‘ë¥¼ ë¹ ì§ì—†ì´, 
> ë‹¤ì„¯ ê°€ì§€ ê·œì•½ì„ í™•ì‹¤íˆ ì§€ì¼œê°€ë©° ë¹„êµí•´ì•¼ í•œë‹¤.
> 

<br>

## item 11. equalsë¥¼ ì¬ì •ì˜í•˜ë ¤ê±°ë“  hashCodeë„ ì¬ì •ì˜í•˜ë¼

- equalsë¥¼ ì¬ì •ì˜í•œ í´ë˜ìŠ¤ ëª¨ë‘ì—ì„œ hashCodeë„ ì¬ì •ì˜í•´ì•¼ í•œë‹¤.

**Object ëª…ì„¸ì—ì„œ ë°œì·Œí•œ ê·œì•½**

- equals ë¹„êµì— ì‚¬ìš©ë˜ëŠ” ì •ë³´ê°€ ë³€ê²½ë˜ì§€ ì•Šì•˜ë‹¤ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ ê·¸ ê°ì²´ì˜ hashCode ë©”ì„œë“œëŠ” ëª‡ ë²ˆì„ í˜¸ì¶œí•´ë„ ì¼ê´€ë˜ê²Œ í•­ìƒ ê°™ì€ ê°’ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤.
- equals(Object)ê°€ ë‘ ê°ì²´ë¥¼ ê°™ë‹¤ê³  íŒë‹¨í–ˆë‹¤ë©´, ë‘ ê°ì²´ì˜ hashCodeëŠ” ë˜‘ê°™ì€ ê°’ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤.
- equals(Object)ê°€ ë‘ ê°ì²´ë¥¼ ë‹¤ë¥´ë‹¤ê³  íŒë‹¨í–ˆë”ë¼ë„, ë‘ ê°ì²´ì˜ hashCodeê°€ ì„œë¡œ ë‹¤ë¥¸ ê°’ì„ ë°˜í™˜í•  í•„ìš”ëŠ” ì—†ë‹¤. ë‹¨, ë‹¤ë¥¸ ê°ì²´ì— ëŒ€í•´ì„œëŠ” ë‹¤ë¥¸ ê°’ì„ ë°˜í™˜í•´ì•¼ í•´ì‹œí…Œì´ë¸”ì˜ ì„±ëŠ¥ì´ ì¢‹ì•„ì§„ë‹¤.











ğŸ“ğŸ””ğŸ”

> Code Reference : [https://github.com/WegraLee/effective-java-3e-source-code/tree/master/src/effectivejava](https://github.com/WegraLee/effective-java-3e-source-code/tree/master/src/effectivejava)